<!DOCTYPE html> 
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Simulador de alineamiento entre tu priorización temática y los planes de gobierno</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 1.5rem;
      background: #f5f5f5;
      color: #111;
    }
    h1, h2, h3 { margin-top: 0; }
    .container {
      max-width: 1100px;
      margin: 0 auto;
      background: #fff;
      padding: 1.5rem 2rem 2rem;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.05);
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 1.5rem;
    }
    .card {
      background: #fafafa;
      border-radius: 12px;
      padding: 1rem 1.25rem;
      border: 1px solid #e1e1e1;
    }
    label {
      display: block;
      font-size: 0.9rem;
      margin-bottom: 0.25rem;
      font-weight: 600;
    }
    input[type="number"] {
      width: 100%;
      padding: 0.4rem 0.5rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 0.9rem;
      box-sizing: border-box;
    }
    .axis-desc {
      margin-top: 0.5rem;
      font-size: 0.78rem;
      color: #444;
      line-height: 1.4;
    }
    .btn {
      display: inline-block;
      padding: 0.6rem 1.4rem;
      border-radius: 999px;
      border: none;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      margin-top: 1rem;
      background: #1a3cff;
      color: #fff;
      margin-right: 0.5rem;
    }
    .btn-secondary {
      background: #e4e7ff;
      color: #1a3cff;
    }
    .results { margin-top: 2rem; }
    .badge {
      display: inline-block;
      padding: 0.15rem 0.6rem;
      border-radius: 999px;
      font-size: 0.7rem;
      font-weight: 600;
      background: #e7edff;
      color: #1a3cff;
      text-transform: uppercase;
      letter-spacing: 0.03em;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
      font-size: 0.9rem;
    }
    th, td {
      padding: 0.45rem 0.4rem;
      border-bottom: 1px solid #eee;
      text-align: right;
    }
    th:first-child, td:first-child { text-align: left; }
    tr.highlight { background: #f0f4ff; font-weight: 600; }
    .axis-summary {
      font-size: 0.85rem;
      margin-top: 0.5rem;
      color: #555;
    }
    .alert {
      margin-top: 0.5rem;
      font-size: 0.8rem;
      color: #a00;
    }
    .footer-note {
      margin-top: 2rem;
      font-size: 0.75rem;
      color: #666;
      border-top: 1px solid #e1e1e1;
      padding-top: 0.75rem;
    }
    .method-note {
      margin-top: 1rem;
      padding: 0.6rem 0.8rem;
      border-left: 4px solid #1a3cff;
      background: #f5f7ff;
      font-size: 0.8rem;
      color: #444;
    }
    @media (max-width: 600px) {
      body { padding: 0.75rem; }
      .container { padding: 1rem 1.1rem 1.5rem; }
    }
  </style>
</head>
<body>
<div class="container">
  <h1>Simulador de alineamiento entre tu priorización temática y los planes de gobierno</h1>
  <p style="font-size:0.9rem;max-width:760px;">
    Este simulador se basa en un análisis automatizado del texto de los planes de gobierno de las diez candidaturas
    que lideran la Encuesta de Opinión Pública ECP–CIEP-UCR del 3 de diciembre de 2025. A partir de ese corpus se
    identificaron cinco ejes temáticos transversales que agrupan la mayor parte de las propuestas: 
    <strong>Desarrollo Económico Integral</strong>, <strong>Desarrollo Social Inclusivo</strong>, 
    <strong>Gestión de Recursos Naturales</strong>, <strong>Reforma Institucional y Eficiencia Financiera</strong> y 
    <strong>Seguridad y Justicia Integral</strong>.
  </p>
  <p style="font-size:0.9rem;max-width:760px;">
    El propósito de este ejercicio es que asignés un peso (0–100) a cada uno de estos ejes según la importancia que
    tiene en tu decisión de voto. Luego se compara tu distribución con el volumen relativo de texto que cada plan de
    gobierno dedica a esos mismos ejes, calculando la suma de diferencias absolutas en puntos porcentuales para
    mostrar con cuál candidatura te aproximás más en términos de énfasis temático.
  </p>
  <p style="font-size:0.9rem;max-width:760px;">
    Este ejercicio es direccional y práctico, no exhaustivo ni definitivo: aproxima la importancia que cada
    candidatura parece otorgar a los temas por el espacio que les dedica en su plan, pero no evalúa la calidad,
    viabilidad o impacto de las propuestas. Tu decisión final debería considerar también el desempeño de las
    candidaturas en debates y entrevistas, sus cualidades de liderazgo y equipos cercanos, la evolución del contexto
    electoral y las conversaciones informadas con personas de confianza.
  </p>

  <h2>1. Asigna un peso a cada eje temático</h2>
  <p style="font-size:0.85rem;">
    Los pesos deben sumar <strong>100</strong> entre todos los ejes. Usa los textos descriptivos para guiarte sobre
    qué abarca cada uno.
  </p>

  <form id="weightsForm">
    <div class="grid">
      <!-- Reforma Institucional y Eficiencia Financiera -->
      <div class="card">
        <label for="reforma">Reforma Institucional y Eficiencia Financiera</label>
        <input type="number" id="reforma" min="0" max="100" step="1" value="0">
        <div class="axis-desc">
          Iniciativas que buscan transformar y optimizar la gestión pública mediante reformas administrativas,
          financieras, legales y tecnológicas, orientadas a reducir duplicidades, fortalecer la rendición de cuentas,
          mejorar la equidad y eficiencia fiscal, y garantizar el acceso justo a servicios esenciales como vivienda y
          pensiones bajo un marco regulatorio actualizado y transparente.
        </div>
      </div>

      <!-- Seguridad y Justicia Integral -->
      <div class="card">
        <label for="seguridad">Seguridad y Justicia Integral</label>
        <input type="number" id="seguridad" min="0" max="100" step="1" value="0">
        <div class="axis-desc">
          Iniciativas que articulan acciones estatales para fortalecer la seguridad pública, la prevención y
          persecución del delito, la integridad institucional y la protección ciudadana mediante sistemas policiales,
          judiciales y de inteligencia, promoviendo la paz social y la dignidad en respuesta a fenómenos criminales,
          violencia, corrupción, narcotráfico y desafíos asociados a la inseguridad en Costa Rica.
        </div>
      </div>

      <!-- Gestión de Recursos Naturales -->
      <div class="card">
        <label for="recursos">Gestión de Recursos Naturales</label>
        <input type="number" id="recursos" min="0" max="100" step="1" value="0">
        <div class="axis-desc">
          Iniciativas que promueven el manejo sostenible, responsable y tecnológicamente avanzado de los recursos
          naturales, energéticos e hídricos, integrando la producción agrícola, pesquera y urbana con la conservación
          ambiental, la adaptación climática y la gobernanza participativa para asegurar el bienestar comunitario y la
          biodiversidad en Costa Rica.
        </div>
      </div>

      <!-- Desarrollo Social Inclusivo -->
      <div class="card">
        <label for="social">Desarrollo Social Inclusivo</label>
        <input type="number" id="social" min="0" max="100" step="1" value="0">
        <div class="axis-desc">
          Iniciativas que promueven el acceso equitativo y la mejora continua de la educación, salud, cultura y
          bienestar, priorizando la inclusión de grupos diversos y vulnerables mediante acciones transversales
          orientadas a reducir brechas sociales, fortalecer capacidades y garantizar oportunidades para todos los
          sectores de la población costarricense.
        </div>
      </div>

      <!-- Desarrollo Económico Integral -->
      <div class="card">
        <label for="economico">Desarrollo Económico Integral</label>
        <input type="number" id="economico" min="0" max="100" step="1" value="0">
        <div class="axis-desc">
          Iniciativas que impulsan la modernización productiva y comercial mediante la integración de tecnología
          digital, innovación, movilidad, alianzas estratégicas y formación de capital humano, orientadas a fortalecer
          la competitividad nacional, la infraestructura de transporte y turismo, la ciberseguridad y la atracción de
          inversión extranjera en un entorno empresarial dinámico y regionalmente articulado.
        </div>
      </div>
    </div>

    <div class="axis-summary" id="sumInfo"></div>
    <div class="alert" id="alert"></div>

    <button type="submit" class="btn">Calcular alineamiento</button>
    <button type="button" class="btn btn-secondary" id="resetBtn">Reiniciar valores</button>
  </form>

  <div class="results" id="results" style="display:none;">
    <h2>2. Resultados de alineamiento</h2>
    <p id="bestMatchText" style="font-size:0.95rem;"></p>
    <p id="bestMatchProfile" style="font-size:0.85rem;color:#444;"></p>

    <div class="method-note">
      Este resultado muestra únicamente el nivel de alineamiento entre tu distribución de importancia por eje temático
      y la distribución de contenidos de los planes. Se calcula mediante la suma de diferencias absolutas en puntos
      porcentuales y no constituye una evaluación integral de las candidaturas.
    </div>

    <h3>Detalle por candidatura</h3>
    <table id="resultsTable">
      <thead>
        <tr>
          <th>Candidatura</th>
          <th>Diferencia total (suma absoluta)</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <h3 style="margin-top:1.75rem;">Comparación gráfica de tu perfil vs el plan mejor alineado</h3>
    <p style="font-size:0.8rem;color:#555;">
      Barras en porcentaje de peso relativo por eje temático (tú vs plan mejor alineado).
    </p>
    <canvas id="comparisonChart" width="400" height="220"></canvas>

    <p class="axis-summary" id="axisBreakdown"></p>

    <div style="margin-top:2rem;border-top:1px solid #e1e1e1;padding-top:1.2rem;">
      <h3>Antes de tomar tu decisión de voto, te recomiendo también:</h3>

      <ol style="font-size:0.9rem;line-height:1.5;color:#333;">
        <li>
          Conocer más sobre la viabilidad política, fiscal y de ejecución de las propuestas,
          más allá de lo que dice el documento del plan de gobierno.
        </li>
        <li>
          Observar el desempeño de la candidatura en debates, entrevistas y momentos de presión
          para evaluar claridad, criterio, coherencia y capacidad de liderazgo.
        </li>
        <li>
          Conocer mejor el perfil del candidato y sus cualidades de liderazgo, el equipo cercano
          y posibles figuras de gobierno; las decisiones de país no dependen solo de una persona.
        </li>
        <li>
          Analizar cómo evoluciona el contexto electoral, la discusión pública y los hechos nuevos
          que puedan surgir durante la campaña.
        </li>
        <li>
          Conversar de manera abierta e informada con familiares, amigos y personas de confianza
          para contrastar perspectivas.
        </li>
      </ol>
    </div>
  </div>

  <div class="footer-note">
    Nota metodológica: Para estimar el peso temático de cada eje en los planes de gobierno, el contenido se dividió en
    segmentos de texto de aproximadamente 2.000 caracteres, utilizando un solapamiento de 200 caracteres entre
    segmentos consecutivos. Sobre estos segmentos —tratados como documentos analíticos— se aplicó un modelo de tópicos
    (Parallel LDA) y se seleccionó el número óptimo de tópicos (k) mediante una evaluación comparativa. Posteriormente,
    los tópicos se agruparon e interpretaron en los cinco ejes utilizados en este simulador, y se nombraron y descritos
    con apoyo de ChatGPT-4.1 a partir de los términos y pesos estimados por el modelo.
  </div>
</div>

<script>
  // Orden de ejes en los datos:
  // 1) Reforma Institucional y Eficiencia Financiera
  // 2) Seguridad y Justicia Integral
  // 3) Gestión de Recursos Naturales
  // 4) Desarrollo Social Inclusivo
  // 5) Desarrollo Económico Integral
  const axisNames = [
    "Reforma Institucional y Eficiencia Financiera",
    "Seguridad y Justicia Integral",
    "Gestión de Recursos Naturales",
    "Desarrollo Social Inclusivo",
    "Desarrollo Económico Integral"
  ];

  // Distribución temática de cada candidatura por eje (%), en el mismo orden
  const candidateAxes = {
    "Álvaro Ramos":          [3.8, 13.9, 19.2, 33.5, 29.5],
    "Ariel Robles":          [7.5, 20.4, 13.6, 42.6, 15.9],
    "Claudia Dobles":        [6.9, 10.2, 24.2, 34.3, 24.4],
    "Eli Feinzaig":          [14.2, 13.1, 16.8, 21.7, 34.2],
    "Fabricio Alvarado":     [4.5, 34.1, 12.0, 28.6, 20.8],
    "José Aguilar Berrocal": [5.6, 23.2, 10.4, 27.0, 33.9],
    "Juan Carlos Hidalgo":   [7.9, 14.3, 16.1, 29.2, 32.5],
    "Laura Fernández":       [56.6, 8.1, 7.0, 16.2, 12.2],
    "Luz Mary Alpízar":      [8.3, 12.7, 13.5, 43.4, 22.1],
    "Natalia Díaz":          [8.9, 15.4, 16.0, 29.6, 30.0]
  };

  const candidateProfiles = {
    "Álvaro Ramos": "Perfil orientado a desarrollo económico y social con peso relevante en gestión de recursos naturales.",
    "Ariel Robles": "Perfil con fuerte énfasis en desarrollo social inclusivo y justicia integral.",
    "Claudia Dobles": "Perfil relativamente equilibrado entre desarrollo social, económico y gestión de recursos naturales.",
    "Eli Feinzaig": "Perfil centrado en desarrollo económico integral con enfoque de mercado.",
    "Fabricio Alvarado": "Perfil con fuerte prioridad en seguridad y justicia integral.",
    "José Aguilar Berrocal": "Perfil que combina énfasis en seguridad, economía y desarrollo social.",
    "Juan Carlos Hidalgo": "Perfil liberal con alto peso en economía y desarrollo social.",
    "Laura Fernández": "Perfil fuertemente concentrado en reforma institucional y eficiencia del Estado.",
    "Luz Mary Alpízar": "Perfil con énfasis marcado en desarrollo social inclusivo.",
    "Natalia Díaz": "Perfil mixto con peso relevante en economía, recursos naturales y desarrollo social."
  };

  const form = document.getElementById("weightsForm");
  const resetBtn = document.getElementById("resetBtn");
  const sumInfo = document.getElementById("sumInfo");
  const alertBox = document.getElementById("alert");
  const resultsDiv = document.getElementById("results");
  const bestMatchText = document.getElementById("bestMatchText");
  const bestMatchProfile = document.getElementById("bestMatchProfile");
  const resultsTableBody = document.querySelector("#resultsTable tbody");
  const axisBreakdown = document.getElementById("axisBreakdown");
  const chartCanvas = document.getElementById("comparisonChart");
  let comparisonChart = null;

  function formatNumber(x, decimals=1) {
    return x.toFixed(decimals).replace(".", ",");
  }

  function getAxisWeights() {
    const ids = ["reforma","seguridad","recursos","social","economico"];
    const values = [];
    let sum = 0;
    ids.forEach(id => {
      const v = parseFloat(document.getElementById(id).value || "0");
      const val = isNaN(v) ? 0 : v;
      values.push(val);
      sum += val;
    });
    return { values, sum };
  }

  function updateSumInfo() {
    const { values, sum } = getAxisWeights();
    if (sum === 0) {
      sumInfo.textContent = "Aún no has ingresado pesos. Cuando lo hagas, se mostrará un resumen de tu distribución.";
      alertBox.textContent = "";
      return;
    }
    const normalized = values.map(v => v * 100 / sum);
    sumInfo.textContent =
      `Suma total ingresada: ${formatNumber(sum,1)}. ` +
      `Distribución relativa: ${axisNames.map((n,i) => `${n} ${formatNumber(normalized[i])}%`).join(", ")}.`;
    alertBox.textContent = "";
  }

  form.addEventListener("input", updateSumInfo);
  updateSumInfo();

  form.addEventListener("submit", function(e) {
    e.preventDefault();
    const { values, sum } = getAxisWeights();

    const tolerance = 0.5;
    if (sum === 0) {
      alertBox.textContent = "Por favor ingresa algún peso distinto de cero en los ejes temáticos.";
      resultsDiv.style.display = "none";
      return;
    }
    if (Math.abs(sum - 100) > tolerance) {
      alertBox.textContent =
        `La suma de los pesos debe ser 100. Actualmente suma ${formatNumber(sum,1)}. ` +
        `Ajusta los valores antes de continuar.`;
      resultsDiv.style.display = "none";
      return;
    }

    // Normalizamos (por si hay 99/101 por redondeo)
    const normalized = values.map(v => v * 100 / sum);

    // Calcular suma de diferencias absolutas por candidatura
    const results = [];
    for (const [name, axes] of Object.entries(candidateAxes)) {
      let absSum = 0;
      for (let i = 0; i < axes.length; i++) {
        absSum += Math.abs(normalized[i] - axes[i]);
      }
      results.push({ name, absSum, axes });
    }
    results.sort((a,b) => a.absSum - b.absSum);

    const best = results[0];

    bestMatchText.innerHTML =
      `<span class="badge">Mejor alineamiento</span> ` +
      `El plan de gobierno que más se aproxima a tu distribución de ejes temáticos es el de <strong>${best.name}</strong> ` +
      `con una diferencia total de <strong>${formatNumber(best.absSum,1)} puntos porcentuales</strong>.`;

    bestMatchProfile.textContent =
      candidateProfiles[best.name] || "Descripción pendiente de completar para esta candidatura.";

    resultsTableBody.innerHTML = "";
    results.forEach((r, idx) => {
      const tr = document.createElement("tr");
      if (idx === 0) tr.classList.add("highlight");
      tr.innerHTML = `<td>${r.name}</td><td>${formatNumber(r.absSum,1)} pp</td>`;
      resultsTableBody.appendChild(tr);
    });

    axisBreakdown.textContent =
      `Tus pesos normalizados para el cálculo fueron: ` +
      axisNames.map((n,i) => `${n} ${formatNumber(normalized[i])}%`).join(", ") + ".";

    // Gráfico
    if (comparisonChart) comparisonChart.destroy();
    comparisonChart = new Chart(chartCanvas, {
      type: 'bar',
      data: {
        labels: axisNames,
        datasets: [
          {
            label: 'Tus prioridades',
            data: normalized,
            backgroundColor: 'rgba(26, 60, 255, 0.6)'
          },
          {
            label: `Plan de ${best.name}`,
            data: best.axes,
            backgroundColor: 'rgba(120, 120, 120, 0.6)'
          }
        ]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: true,
            max: 100,
            ticks: { callback: value => value + '%' }
          }
        },
        plugins: {
          legend: { position: 'bottom' },
          tooltip: {
            callbacks: {
              label: ctx => `${ctx.dataset.label}: ${ctx.parsed.y.toFixed(1)}%`
            }
          }
        }
      }
    });

    resultsDiv.style.display = "block";
    alertBox.textContent = "";
  });

  resetBtn.addEventListener("click", () => {
    ["reforma","seguridad","recursos","social","economico"].forEach(id => {
      document.getElementById(id).value = 0;
    });
    if (comparisonChart) {
      comparisonChart.destroy();
      comparisonChart = null;
    }
    resultsDiv.style.display = "none";
    alertBox.textContent = "";
    updateSumInfo();
  });
</script>
</body>
</html>

